@php
    $orderType = ['A', 'B', 'C', 'D'];
    $data = [
        [
            'ques' =>
                'Which of the following correctly describes vision statement and mission statement, respectively?',
            'choices' => [
                'The mission statement describes what the organization, “Who are we?” The mission statement guides subsequently the development of the vision statement. The vision statement describes what the organization is committed to do or how it will act and answers the question, “What do we do?”',
                'The vision statement describes what the organization intends to be or become and answers the question, “Who are we?” The vision statement guides subsequently the development of the mission statement. The mission statement describes what the organization is committed to do or how it will act and answers the question, “What do we do?”',
                'The vision statement describes what the organizars the question, “What do we do?” The vision statement guides subsequently the development of the mission statement. The mission statement describes what the organization is committed to do or how it will act and answers the question, “Who are we?”',
                'The mission statement describes what the organizand answers the question, “Who are we?” The mission statement guides subsequently the development of the vision statement. The vision statement describes what the organization intends to be or become and answers the question, “What do we do?”',
            ],
            'correct' => 1,
            'explaination' => 'Đáp án đúng B: Bởi vì nó dài nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company focuses its advertisements on how its product costsny focuses its  less than similar products sold by competitors.',
                'A company focuses its advertisements on hny focuses its ow its product is s product is s product is higher quality than similar products sold by competitors.',
                'A company chooses not to advertise its product as a way tls products innyls products innyo cut costs.',
                'A company focuses its advertisements on how it sells products inny focuses its  one industry segment and is therefore an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúng: C: Bởi vì câu này ngắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company focuses its advertisements on how its product costsny focuses its  less than similar products sold by competitors.',
                'A company focuses its advertisements on hny focuses its ow its product is s product is s product is higher quality than similar products sold by competitors.',
                'A company chooses not to advertise its product as a way tls products innyls products innyo cut costs.',
                'A company focuses its advertisements on how it sells products inny focuses its  one industry segment and is therefore an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúng: C: Bởi vì câu này ngắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company focuses its advertisements on how its product costsny focuses its  less than similar products sold by competitors.',
                'A company focuses its advertisements on hny focuses its ow its product is s product is s product is higher quality than similar products sold by competitors.',
                'A company chooses not to advertise its product as a way tls products innyls products innyo cut costs.',
                'A company focuses its advertisements on how it sells products inny focuses its  one industry segment and is therefore an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúng: C: Bởi vì câu này ngắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
        [
            'ques' =>
                'Which of the following correctly describes an example of following the differentiation strategy?',
            'choices' => [
                'A company rs.',
                'A company fooducts sold by competitors.',
                'A compts innyo cut costs.',
                'A company focusese an expert in that segment.',
            ],
            'correct' => 2,
            'explaination' => 'Đáp án đúắn nhất',
        ],
    ];
@endphp



<div x-data="quizApp({{ json_encode($data) }}, {{ json_encode($orderType) }})" class="p-6" id="quiz">

    <!-- Btn Popup -->
    <x-pages.question-detail.btn-popup />
    <x-pages.question-detail.submit-popup />

    <div class="space-y-6">
        {{-- Result --}}
        <div x-show="isSubmit" id='result'
            class="flex border border-primary.main rounded-2xl justify-between p-6 items-center">
            <p class="font-bold text-3xl text-secondary.main">
                Your score: <span x-text="score"></span>/{{ count($data) }}
            </p>
            <button type="button" @click="retakeQuiz"
                class="flex items-center gap-2 border border-primary.main py-2 px-5 rounded-2xl">
                <span class="font-normal text-sm text-primary.main">Retest</span>
                <x-component.material-icon name='restart_alt' class="w-6 h-6 aspect-square text-primary.main" />
            </button>
        </div>
        <div>
            <!-- Question -->
            <h3 class="font-bold text-3xl text-primary.main mb-6">Questions - 120/120</h3>
            <div class="space-y-6">
                <div class="space-y-8">
                    <template x-for="(item, key) in questions" :key="key">
                        <div class="space-y-4">
                            {{-- Question --}}
                            <p class="font-bold text-lg text-black" :id="'question' + key">
                                Question <span x-text="key + 1"></span>: <span x-text="item.ques"></span>
                            </p>
                            {{-- Choices --}}
                            <div class="space-y-4">
                                <template x-for="(choice, index) in item.choices" :key="index">
                                    <div class="flex gap-2 items-start">
                                        <input :disabled="isSubmit" type="radio"
                                            :id="'question' + key + '-choice' + index"
                                            :name="'question' + key + '-choice' + index" :value="index"
                                            x-model="answers[key]" class="w-6 h-6 aspect-square">
                                        <div class="flex gap-2">
                                            <p class="font-semibold"
                                                :class="{
                                                    'text-primary.main': !isSubmit && parseInt(answers[key]) == index,
                                                    'text-secondary.main': isSubmit && parseInt(answers[key]) ==
                                                        index && answers[
                                                            key] !== item.correct,
                                                    'text-success.main': isSubmit && index === item.correct
                                                }">
                                                <span x-text="orderType[index]"></span>.
                                            </p>
                                            <label :for="'question' + key + '-choice' + index"
                                                :class="{
                                                    'text-primary.main': !isSubmit && parseInt(answers[key]) == index,
                                                    'text-secondary.main': isSubmit && parseInt(answers[key]) ==
                                                        index && answers[
                                                            key] !== item.correct,
                                                    'text-success.main': isSubmit && index === item.correct

                                                }">
                                                <span x-text="choice"></span>
                                            </label>
                                        </div>
                                    </div>
                                </template>
                            </div>
                            {{-- Explaination --}}
                            <div class="space-y-2 border border-primary.main rounded-lg p-4" x-show="isSubmit">
                                <p class="font-semibold text-sm"
                                    :class="{
                                        'text-secondary.main': isSubmit && parseInt(answers[key]) !== item.correct,
                                        'text-success.main': isSubmit && parseInt(answers[key]) === item.correct,

                                    }">
                                    <span
                                        x-text="isSubmit && parseInt(answers[key]) !== item.correct ? 'Sai' : 'Đúng'"></span>
                                </p>
                                <p class="text-base text-primary.main">
                                    <span x-text="item.explaination"></span>
                                </p>
                            </div>
                        </div>
                    </template>
                </div>
                <div class="py-6 border-t border-grey-300">
                    <button type="button" @click="showSubmitModal = true"
                        class="rounded-xl bg-primary.main px-5 py-2.5 flex items-center gap-2 active:opacity-95">
                        <span class="text-white text-sm font-medium">Submit</span>
                        <x-component.material-icon name="arrow_forward" class="text-white w-6 h-6 aspect-square" />
                    </button>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    function quizApp(questions, orderType) {
        return {
            orderType: orderType,
            questions: questions,
            showModal: false,
            showSubmitModal: false,
            answers: {},
            isSubmit: false,
            score: 0,
            submitQuiz() {
                console.log(this.answers);
                let score = 0;
                this.questions.forEach((question, index) => {
                    if (Number(this.answers[index]) == question.correct) {
                        score++;
                    }
                });
                this.score = score;
                this.showSubmitModal = false;
                this.isSubmit = true;
                this.$nextTick(() => {
                    document.getElementById('quiz').scrollIntoView({
                        behavior: 'smooth'
                    });
                });
                // Handle form submission
            },
            retakeQuiz() {
                this.isSubmit = false;
                this.answers = {};
            }
        };
    }
</script>
